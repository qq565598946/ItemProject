"use strict";var indexloading,element=layui.element,layer=layui.layer,form=layui.form,laypage=layui.laypage,upload=layui.upload,formSelects=layui.formSelects,loadingTip=$(".loading-box1");function GetQueryString(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(i);return null!=n?unescape(n[2]):null}var accessToken=GetQueryString("TokenCode"),versionCon=GetQueryString("version"),moduleId=null,additemId=null,flagid=GetQueryString("flagid"),projectid=GetQueryString("projectid"),userName=sessionStorage.getItem("userName"),userId=sessionStorage.getItem("userId"),developLeaderID=sessionStorage.getItem("developLeader"),developLeaderName=sessionStorage.getItem("developLeaderName"),xhsdk=new Xhsdk(appID,appSecretKey);if(xhsdk.setGetaWayUrl(GetaWay_url),xhsdk.setToken(accessToken),xhsdk.setReqType("app"),xhsdk.setUserInfo(null),2==flagid){var itemid=GetQueryString("itemID");additemId=itemid,$(".editOprate").show(),$(".box-tip").hide(),GetitemDestail()}else{var addprojectID=GetQueryString("addprojectID");additemId=addprojectID,$(".editOprate").hide(),$(".box-tip").show(),GetqueryUserBy("staffselect",null,null)}function GetitemDestail(f){var e={accessToken:accessToken,solutionId:additemId};loadingTip.show(),xhsdk.ajax({type:"POST",url:solution+"/projectManagement/list",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){if(405!=e.errorCode)if(200==e.code){var i=e.data.solutioninfoList,n=e.data.overviewList,t=e.data.demanalysisList,a=e.data.archidesignList,o=e.data.microserviceList,s=e.data.applicationdesignList,l=e.data.risksolutionList,d=e.data.overviewaAuditList,c=e.data.demanalysisAuditList,r=e.data.archidesignAuditList,p=e.data.microserviceAuditList,v=e.data.applicationdesignAuditList,u=e.data.risksolutionAuditList;switch(f){case 1:solutionDetail(i);break;case 2:projectDetail(n,d);break;case 3:DetailDemanalysis(t,c);break;case 4:DetailArchidesign(a,r);break;case 5:Detailmicroservice(o,p);break;case 6:Detailapplicationdesign(s,v);break;case 7:Detaildeployrun(l,u);break;default:solutionDetail(i),projectDetail(n,d),DetailDemanalysis(t,c),DetailArchidesign(a,r),Detailmicroservice(o,p),Detailapplicationdesign(s,v),Detaildeployrun(l,u)}loadingTip.hide()}else loadingTip.hide(),layer.msg("请求出现错误!");else layer.msg("请重新登录!")},error:function(e){loadingTip.hide(),layer.msg("请求出现错误!")}})}function auditContent(e,i,n){$(e).find(".show-audit-box ul").empty(),$(e).find(".show-audit-box").empty();for(var t=0;t<i.length;t++){var a='<div class="box-audit-content"><ul><li>审核意见: '+(t+1)+" : "+i[t].opinion+"</li></ul>\n                            <div>审核人 : <span>"+i[t].auditName+"</span></div>\n                            <div>审核时间 : <span>"+i[t].auditTime+"</span></div>\n                            </div>";$(e).find(".show-audit-box").append(a),$(e).find(".audit-box").show()}}function showAuditBox(){$(".audit-box").hover(function(){$(this).find(".show-audit-box").show(600)},function(){$(this).find(".show-audit-box").hide(300)})}function verifyNum(e){$(".anchorNav ul li:eq("+e+")").addClass("verify"),$(".anchorNav ul li:eq("+e+") .font-red").html('<i class="layui-icon-ok layui-icon" style="margin:-5px;font-size: 18px;color:green"></i>'),loadingverify()}function GetqueryUserBy(a,o,s){var e={accessToken:accessToken,deptCode:sessionStorage.getItem("deptCode")};xhsdk.ajax({type:"post",url:solution+"/solutioninfo/queryUserByDeptCode",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){if(200==e.code){if(null==e.data)return;var i=e.data,n=[];n.splice(0,n.length);for(var t=0;t<i.length;t++)n.push({name:i[t].userName,value:i[t].id});formSelects.data(a,"local",{arr:n}),1!=s&&3!=s||formSelects.value(a,o,!0)}else layer.msg("请求出现错误!!")},error:function(e){layer.msg("请求出现错误!!")}})}function solutionDetail(e){if(!(e.length<1)){verifyNum(0),$(".info-box").show();for(var i=0;i<e.length;i++){var n='  <div class="center-box">\n                                                <div class="layui-form-item">\n                                                    <div class="layui-inline">\n                                                        <label class="layui-form-label">方案名称:</label>\n                                                        <div class="layui-input-inline">\n                                                        <input type="tel" name="phone" autocomplete="off" class="layui-input project_Name" disabled value="'+e[i].solutionName+'">\n                                                        </div>\n                                                    </div>\n                                                    <div class="layui-inline">\n                                                        <label class="layui-form-label">编制单位:</label>\n                                                        <div class="layui-input-inline">\n                                                        <input type="tel" name="phone"  autocomplete="off" class="layui-input makeUnit"  disabled value="'+e[i].makeUnit+'" >\n                                                         \n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                <div class="layui-form-item">\n                                                    <div class="layui-inline">\n                                                        <label class="layui-form-label">方案版本:</label>\n                                                        <div class="layui-input-inline">\n                                                        <input type="tel" name="phone"  autocomplete="off" class="layui-input solutionVersion"  disabled value="'+e[i].solutionVersion+'" >\n                                                           \n                                                        </div>\n                                                    </div>\n                                                            <div class="layui-inline">\n                                                                <label class="layui-form-label">开发单位:</label>\n                                                                <div class="layui-input-inline">\n                                                                    <input type="tel" name="phone"  autocomplete="off"  disabled class="layui-input kfdevelopOrgan" id="kfdevelopOrgan" value="'+e[i].developOrgan+'">\n                                                                </div>\n                                                            </div>\n                                                    <div class="layui-inline">\n                                                        <label class="layui-form-label" style="width: 130px">开发单位负责人:</label>\n                                                        <div class="layui-input-inline">\n                                                            \x3c!--<div class="layui-input-inline" style="width: 250px">--\x3e\n                                                                             \x3c!--<select xm-select="staffselect" xm-select-search="" xm-select-max="2">--\x3e\n\n                                                                                     \x3c!--</select>--\x3e\n                                                                    \x3c!--</div>--\x3e\n                                                            <input type="tel" name="phone"  autocomplete="off" class="layui-input staffvalue" disabled value="'+e[i].developLeaderName+'" >\n                                                               \n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            <div class="change-btn solutioneditID" onclick="editbasicinfo(this)" data-edit="'+e[i].id+'">\n                                                <i class="iconfont icon-bianji"></i>\n                                            </div>\n                                        </div>';$(".info-box").html(n),GetqueryUserBy("staffselect",e[i].developLeader.split(","),1);var t=e[i].developerName,a=e[i].developer.split(",");if(0<t.length){var o='<div class="edit-staff-box">\n                                <div class="edit-staff-content">\n                                    <div class="layui-inline">\n                                        <label class="layui-form-label">开发人员:</label>\n                                        <div class="layui-input-inline" style="width:600px">\n                                            <input type="tel" name="phone"  autocomplete="off" disabled style="border: 0px" class="layui-input verify-value staff-content"  value="'+e[i].developerName+'">\n                                        </div>\n                                    </div>\n                                </div>\n                            <div class="change-btn" onclick="editsatff(this)">\n                                 <a href="#pj-staffvalue"><i class="iconfont icon-bianji"></i></a>\n                            </div>\n                        </div>';$(".staff-box-edit-done").html(o),GetqueryUserBy("developerName_select",a,3),verifyNum(8),$("#pj-staffvalue .levelTips").hide(),$("#pj-staffvalue .addItem-box").hide(),showstaffbtn()}}}}function projectDetail(e,i){if(!(e.length<1)){0<i.length&&auditContent("#pj-overview",i),$("#pj-overview .levelTips").hide(),verifyNum(1),$("#pj-overview .addItem-box").hide();for(var n=0;n<e.length;n++){var t='<div class="overview-box edit-back-box">\n                                <div class="edit-con-box-btn">\n                                    <div class="edit-btn" onclick="editOverview(this)" data-edit="'+e[n].id+'"><a href="#pj-overview"><i class="iconfont icon-bianji"></i></a></div>\n                              </div> \n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">项目背景</p>\n                                    <div class="editOprate">\n\n                                    </div>\n                                </div>\n                                <div class="pj-item-body-bottom pj-background">\n                                        <p>'+e[n].projectBackground+'</p>\n                                </div>\n                            </div>\n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">系统现状</p>\n                                    <div class="editOprate">\n                                    </div>\n                                </div>\n                                <div class="pj-item-body-bottom systemCurrent">\n                                        <p>'+e[n].systemCurrent+'</p>\n                                </div>\n                            </div>\n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">建设目标</p>\n                                    <div class="editOprate">\n\n                                    </div>\n                                </div>\n                                <div class="pj-item-body-bottom buildGoal">\n                                    <p>'+e[n].buildGoal+'</p>\n                                </div>\n                            </div>\n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">建设内容</p>\n\n                                </div>\n                                <div class="pj-item-body-bottom buildContent">\n                                    <p>'+e[n].buildContent+"</p>\n                                </div>\n                            </div>\n                        </div>";$("#edit-box-overview").html(t)}showoverviewbtn()}}function DetailDemanalysis(e,i){var n=$("#pj-demandAnalysis .addItem-box");if(e.length<1)n.show();else{0<i.length&&auditContent("#pj-demandAnalysis",i),$("#pj-demandAnalysis .levelTips").hide(),verifyNum(2),n.hide();for(var t=0;t<e.length;t++){var a='  <div class="box-content-deman edit-back-box">\n                                <div class="edit-con-box-btn">\n                                    <div class="edit-btn"  onclick="editdemanna(this)" data-edit="'+e[t].id+'"><a href="#pj-demandAnalysis"><i class="iconfont icon-bianji"></i></a></div>\n                                 </div> \n                                <div class="secLevel">\n                                    <div class="pj-item-body-top">\n                                        <p class="editTitle">功能角色分析</p>\n\n                                    </div>\n                                    <div class="pj-item-body-bottom">\n                                        <p class="functionalRoleAnalysis">'+e[t].functionalRoleanalysis+'</p>\n                                    </div>\n                                </div>\n                                <div class="secLevel">\n                                    <div class="pj-item-body-top">\n                                        <p class="editTitle">业务需求</p>\n                                    </div>\n                                    <div class="pj-item-body-bottom">\n                                        <p class=" businessRequirements">'+e[t].businessRequirements+'</p>\n                                    </div>\n                                </div>\n                                <div class="secLevel">\n                                    <div class="pj-item-body-top">\n                                        <p class="editTitle">数据资源整合</p>\n\n                                    </div>\n\n                                    <div class="pj-item-body-bottom">\n                                        <p class="dataIntegration">'+e[t].dataIntegration+"</p>\n                                    </div>\n                                </div>\n                            </div>";$("#edit-box-deman").html(a)}showoverviewbtn()}}function DetailArchidesign(e,i){var n=$("#pj-design .addItem-box"),t=$("#pj-design .editCon-box-three");if(!(e.length<1)){n.hide(),t.show(),0<i.length&&auditContent("#pj-design",i),$("#pj-design .levelTips").hide(),$("#new-add-design").hide(),verifyNum(3);for(var a=0;a<e.length;a++){var o='<div class="new-add-destail edit-back-box">\n                                     <div class="edit-con-box-btn">\n                                    <div class="edit-btn" onclick="designEditdata(this)" data-edit="'+e[a].id+'"><a href="#pj-design"><i class="iconfont icon-bianji"></i></a></div>\n                                 </div> \n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">总体架构</p>\n                                </div>\n                                <div class="pj-item-body-bottom">\n                                    <p class="frameworkdesign">'+e[a].frameworkDesign+'</p>\n                                </div>\n                            </div>\n                            <div class="secLevel">\n                                <div class="pj-item-body-top" >\n                                    <p class="editTitle">网络拓扑图</p>\n                                </div>\n                                <div class="pj-item-body-bottom">\n                                    <p class="img-url" style="display: none"></p>\n                                    <div class="layui-upload-list">\n                                        <img class="layui-upload-img" src="'+e[a].topologicalPic+'" id="networkImg">\n                                        <p class="demoText"></p>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="secLevel">\n                                <div class="pj-item-body-top">\n                                    <p class="editTitle">系统建设原则及路线</p>\n                                </div>\n                                <div class="pj-item-body-bottom">\n                                    <p class="principlesroutes">'+e[a].principlesRoutes+"</p>\n                                </div>\n                            </div>\n\n                        </div>";$("#new-add-back").html(o),showoverviewbtn()}}}function Detailmicroservice(e,i){var n=[],t=($("#pj-service .addItem-box"),$("#pj-service .editCon-box-four"));if($(".service-box").empty(),!(e.length<1)){0<i.length&&auditContent("#pj-service",i,5),t.show(),$("#pj-service .levelTips").hide(),verifyNum(5);for(var a=0;a<e.length;a++){var o=e[a].generalService.split(","),s=e[a].basicService.split(",");n.push(e[a].serviceType),t.attr("data-edit",e[a].id);var l='<div class="pj-item-body service-list layui-form microserviceList'+a+'" data-id="'+a+'">\n                                \n                              <div class="edit-con-box-btn">\n                                <div class="edit-btn"  onclick="editservice(this)" data-edit="'+e[a].id+'"><a href="#pj-service"><i class="iconfont icon-bianji"></i></a></div>\n                                <div class="del-template" onclick="delContent(this,1)" data-edit="'+e[a].id+'"><i class="iconfont icon-icon"></i></div>\n                              </div>                  \n                         <div class="secLevel">\n                         <div class="pj-item-body-top layui-form">\n                          <div class="deploy">\n                        <p class="editTitle">服务名称</p>\n                            <p class="serviceName">'+e[a].serviceName+'</p>\n                                        \n                        </div>\n                         </div>\n                       \n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top layui-form">\n                            <div class="deploy">\n                                <p class="editTitle">服务类型</p>\n                                <div class="layui-input-inline option-left" style="width:180px" >\n                                    <select name="quiz"  disabled class="serviceType'+a+'">\n                                        <option value="3">应用服务</option>\n                                        <option value="1">基础技术服务</option>\n                                        <option value="2">通用业务服务</option>\n                                       \n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">服务设计</p>\n                        </div>\n                        <div class="pj-item-body-bottom">\n                                <p class="serviceDesign">'+e[a].serviceDesign+'</p>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">依赖的服务</p>\n                            <div class="editOprate">\n                                <div class="editCon">\n                                    \x3c!--<i class="iconfont icon-bianji"></i>--\x3e\n                                    \x3c!--<span>编辑</span>--\x3e\n                                </div>\n                            </div>\n                        </div>\n                        <div class="pj-item-body">\n                            <div class="common">通用业务服务(多选)</div>\n                             <div class="box-select-business layui-input-inline" style="margin:20px 0px; width: 100%">\n                                <select xm-select="business_des'+a+'" disabled>\n                                               \n                                </select>\n                            </div>\n                        \n                            <div class="common">基础技术服务(多选)</div>\n                              <div class="box-select-technical layui-input-inline" style="margin:20px 0px;width: 100%">\n                                <select xm-select="technical_des'+a+'" disabled>\n                                                 \n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                \x3c!--部署环境和运行资源--\x3e\n                <div class="secLevel">\n                    <div class="pj-item-body-top">\n                        <p class="editTitle">部署环境和运行资源</p>\n                    </div>\n                    <div class="deploy-edit">\n                        <div class="deploy-box-tip1">\n                            <div class="deploy">\n                                <p class="common">部署环境</p>\n                                <div class="option-box">\n                                \x3c!--<p>'+e[a].deploymentEnvironment+'</p>--\x3e\n                                    <select name="quiz"  class="deploymentEnvironment" disabled>\n                                        <option value="'+e[a].deploymentEnvironment+'">'+e[a].deploymentEnvironment+'</option>\n                                    </select>\n                                </div>\n                            </div>\n                            <div class="deploy">\n                                <p class="common">运行资源</p>\n                                <div class="option-box">\n                                    \x3c!--<p>'+e[a].runResource+'</p>--\x3e\n                                    <select name="quiz"  class="runResource" disabled>\n                                        <option value="'+e[a].runResource+'">'+e[a].runResource+"</option>\n                                    </select>\n                                </div>\n                            </div>            \n                        </div>\n                    </div>\n                </div>\n                \n                </div>";$(l).appendTo(".service-box"),$(".serviceType"+a+" option[value = "+e[a].serviceType+"]").attr("selected","selected"),GetserviceData("business_des"+a,"technical_des"+a,s,o,3),form.render()}editbth(a)}}function editbth(){$(".service-list").hover(function(){$(this).find(".edit-con-box-btn").show()},function(){$(this).find(".edit-con-box-btn").hide()})}function Detailapplicationdesign(e,i){$("#pj-application .editCon-box-five");if($(".application-box").empty(),!(e.length<1)){0<i.length&&auditContent("#pj-application",i,5),$("#pj-application .levelTips").hide(),verifyNum(6);for(var n=null,t=0;t<e.length;t++){n=e[t].frontIntegration.split(",");var a='<div class="pj-item-body qdservice-box service-list layui-form appliction-list'+t+'"  data-id="'+t+'">\n                <div class="edit-con-box-btn">\n                  <div class="edit-btn" onclick="editapplication(this)" data-edit="'+e[t].id+'"><a href="#pj-application"><i class="iconfont icon-bianji"></i></a></div>\n                  <div class="del-template" onclick="delContent(this,2)" data-edit="'+e[t].id+'"><i class="iconfont icon-icon"></i></div>\n              </div>\n                            <div class="secLevel">\n                                    <div class="deploy">\n                                      <p class="editTitle">应用名称</p>\n                                        <p class="editTitle applicationName">'+e[t].applicationName+'</p>\n                                            \n                                    </div>\n                             </div>   \n        <div class="secLevel">\n            <div class="pj-item-body-top">\n                <p class="editTitle">应用概述</p>\n            </div>\n            <div class="pj-item-body-bottom">\n              <p class="applicationOverview">'+e[t].applicationOverview+'</p>\n            </div>\n        </div>\n        <div class="secLevel">\n            <div class="pj-item-body-top">\n                <p class="editTitle">应用UI/UE规划</p>\n            </div>\n            <div class="pj-item-body-bottom" id="">\n             <div class="applicationPlanning">'+e[t].applicationPlanning+'</div>\n            </div>\n        </div>\n        <div class="secLevel">\n            <div class="pj-item-body-top">\n                <p class="editTitle">应用功能逻辑</p>\n            </div>\n            <div class="pj-item-body-bottom" id="">\n               <p class="applyLogicdiagram">'+e[t].applyLogicdiagram+'</p>\n            </div>\n        </div>\n        <div class="secLevel">\n            <div class="pj-item-body-top" style="margin-top:30px;">\n                <div class="deploy">\n                    <p class="editTitle">前端服务化能力集成</p>\n                    <div class="layui-input-inline option-left">\n                        <div class="layui-input-block app-service-box" style="width: 500px">\n                       \n                                \x3c!--<div class="layui-input-inline option-left" style="width:180px" >--\x3e\n                                            \x3c!----\x3e\n                                    \x3c!--</div>--\x3e\n                                     <div class="" style="width: 600px;margin: 20px";>\n                                          \n                                            <select xm-select="select-id'+t+'" disabled="disabled" class="frontIntegration'+t+'">\n                                                <option value="1">人脸识别服务</option>\n                                                <option value="2">车牌识别服务</option>\n                                                <option value="3">证件识别服务</option>\n                                                <option value="4">扫一扫服务</option>\n                                                <option value="5">证件识别服务</option>\n                                                <option value="6">选择文件</option>\n                                                <option value="7">电子签名</option>\n                                                <option value="8">获取定位</option>\n                                                <option value="9">获取手机状态（NFC、蓝牙、GPS、WIFI等）</option>\n                                                <option value="10">设置手机状态（NFC、蓝牙、GPS、WIFI等）</option>\n                                                <option value="11">获取海拔</option>\n                                                <option value="12">图片压缩</option>\n                                            </select>\n                                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>';$(a).appendTo(".application-box"),formSelects.render("select-id"+t),formSelects.value("select-id"+t,n,!0)}editbth()}}function Detaildeployrun(e,i){var n=$("#pj-solution .edit-solution-box"),t=$("#pj-solution .addItem-box");if(e.length<1)t.show();else{0<i.length&&auditContent("#pj-solution",i),t.hide(),n.show(),$("#pj-solution .levelTips").hide(),$("#pj-solution .sumbit-button-box").hide(),$("#pj-solution .editCon-btn").show(),verifyNum(7);for(var a=0;a<e.length;a++){var o='<div class="secLevel">\n                            <div class="pj-item-body-top">\n                                <p class="editTitle">风险解决方案</p>\n                                <div class="editOprate">\n                                      <div class="editCon-btn" onclick="editsolution(this)" data-edit="'+e[a].id+'">\n                                                  <a href="#pj-solution"> <i class="iconfont icon-bianji"></i></a>\n                                                    \n                                                </div>\n                                </div>\n                            </div>\n                            <div class="pj-item-body-bottom"> \n                                <p class="verify-value riskSolution" name="pj_background "  id="edit-riskSolution">'+e[a].riskSolution+"</p>\n                            </div>\n                        </div>\n                          ";$(".edit-solution-box").html(o)}showsolution()}}function showsolution(){$(".edit-solution-box").hover(function(){$(this).find(".editOprate").show()},function(){$(this).find(".editOprate").hide()})}function initnormalize(){var e={accessToken:accessToken};xhsdk.ajax({type:"post",url:solution+"/dictionary/find",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){if(200==e.code){if(e.length<1)return;$(".norm-content").text(e.data[3].content);var i='<option value="'+e.data[2].content+'">'+e.data[2].content+"</option>";$(i).appendTo("#service1");for(var n=0;n<=e.data.length;n++){if(2==n)return;var t='<option value="'+e.data[n].content+'">'+e.data[n].content+"</option>";$(t).appendTo("#service"),form.render()}}else layer.msg(e.data)},error:function(e){layer.msg("请求出现错误!!")}})}$(function(){showAuditBox(),$("#kfdevelopOrgan").val(developLeaderName),$("#staffvalue").val(userName),$("#staffvalue").attr("userId",userId),$("#solutionVersion").val(versionCon),returnTop()});var readstatus=null;function returnTop(){$(window).scroll(function(){100<$(window).scrollTop()?$(".returnTop").fadeIn(1e3):$(".returnTop").fadeOut(1e3)}),$(".returnTop").click(function(){return $("html").scrollTop()?$("html").animate({scrollTop:0},500):$("body").animate({scrollTop:0},500),!1})}function delContent(n,e){var t=null,a=null,o=[];a=1==e?(t=solution+"/projectManagement/removeMicroservice",".service-box"):(t=solution+"/projectManagement/removeApplicationdesign",".application-box"),$(a).find(".service-list").each(function(e,i){o.push(e)}),o.length<=1?layer.msg("至少保留一项"):layer.confirm("确认删除模块吗？",{btn:["确认","取消"]},function(){var e=$(n).data("edit"),i={accessToken:accessToken,id:e};loadingTip.show(),xhsdk.ajax({type:"post",url:t,contentType:"application/json",dataType:"json",data:JSON.stringify(i),success:function(e){200==e.code?(loadingTip.hide(),a=null,layer.msg("删除完成!",{icon:1,time:600},function(){$(n).parent().parent().remove()})):(layer.msg(e.data),loadingTip.hide())},error:function(e){layer.msg("请求出现错误!!"),loadingTip.hide()}}),layer.close()},function(){layer.msg("已取消")})}$(".Read_specification").on("click",function(){var e=$(this).parent().find(".norm-content").text();layer.open({type:1,area:["500px","300px"],title:"开发规范",shade:.2,closeBtn:0,shift:4,shadeClose:!0,content:'<div class="show-content">'+e+'<div class="option-checkbox-txt layui-form"><input type="checkbox" name="like1[write]" lay-skin="primary" title="已阅读" value="1" lay-filter="haveRead"></div></div>'}),form.render(),form.on("checkbox(haveRead)",function(e){readstatus=e.value,$(".notread span").text("已阅读"),layer.msg("已阅读!",{icon:1,time:600},function(){verifyNum(4);layer.getFrameIndex(window.name);layer.closeAll()})})});var edit_id=null;form.verify({project_Name:function(e){return e.length<1?"请输入方案名称":20<e.length?"字数过长,请重新输入!":void 0},kfdevelopOrgan:function(e){if(e.length<1)return"请输入开发单位"},makeUnit:function(e){return e.length<1?"请输入编制单位":20<e.length?"字数过长,请重新输入!":void 0},solutionVersion:function(e){if(e.length<1)return"请输入方案版本"},staffvalue:function(e){if(e.length<1)return"请选择开发负责人"}});var infoflag=0;function basicinfo(){$(".box-tip").hide(),$(".info-box").show();var e=null,i={};e=null==edit_id?(i.id=addprojectID,solution+"/solutioninfo/add"):(i.id=edit_id,$(".change-btn").attr("data-edit",edit_id),solution+"/solutioninfo/modify"),i.accessToken=accessToken,i.projectId=projectid,i.solutionName=$("#project_Name").val(),i.makeUnit=$("#makeUnit").val(),i.makeUnitName=$("#makeUnit").val(),i.solutionVersion=$("#solutionVersion").val(),i.developOrgan=$("#kfdevelopOrgan").val(),i.developer=formSelects.value("developerName_select","valStr"),i.createBy=userName,i.developLeaderName=formSelects.value("staffselect","nameStr"),i.developLeader=formSelects.value("staffselect","valStr"),i.developerName=formSelects.value("developerName_select","nameStr"),loadingTip.show(),xhsdk.ajax({type:"post",url:e,contentType:"application/json",dataType:"json",data:JSON.stringify(i),success:function(e){200==e.code?(loadingTip.hide(),null==edit_id&&$(".change-btn").attr("data-edit",e.data),layer.msg("保存完成!",{icon:1,time:600},function(){GetitemDestail(1),$(".editOprate").show(),edit_id=null,verifyNum(0)})):(loadingTip.hide(),layer.msg(e.data))},error:function(e){loadingTip.hide(),layer.msg("请求出现错误!!")}})}function editbasicinfo(e){infoflag=0;var i=$(e).data("edit");edit_id=i,$(".box-tip").show(),$("#project_Name").val($(".project_Name").val()),$("#makeUnit").val($(".makeUnit").val()),$("#solutionVersion").val($(".solutionVersion").val()),$("#staffvalue").val($(".staffvalue").val()),$("#kfdevelopOrgan").val($(".kfdevelopOrgan").val()),$(".close-deploy").show(),$(".info-box").hide()}function closebasicinfo(){$(".box-tip").hide(),$(".info-box").show()}function savestaff(){formSelects.value("developerName_select","nameStr").length<1?layer.msg("请分配开发人员!"):($(".add-staff-box").hide(),$(".staff-box-edit-done").show(),edit_id=$(".solutioneditID").data("edit"),basicinfo(),$("#pj-staffvalue .addItem-box").hide(),verifyNum(8),showstaffbtn())}function showstaffbtn(){$(".staff-box-edit-done").hover(function(){$(this).css("border","1px solid #ccc"),$(this).find(".change-btn").show()},function(){$(this).css("border","1px solid #fff"),$(this).find(".change-btn").hide()})}function editsatff(e){$(e).data("edit");$("#staffvalue_two").val($(".staff-content").val()),$(".staff-box-edit-done").hide(),$(".add-staff-box").show()}function closebox(){$(".add-staff-box").hide(),$(".staff-box-edit-done").show()}form.on("submit(sumbit-info)",function(e){if(0==infoflag){if(formSelects.value("staffselect","valStr").length<1)return layer.msg("请选择开发单位负责人！"),!1;basicinfo(),infoflag=1}return!1}),$(".info-box").hover(function(){$(".change-btn").show()},function(){$(".change-btn").hide()}),$("#pj-staffvalue .addItem-box").click(function(){$("#pj-staffvalue .levelTips").hide(),$(".add-staff-box").show(),GetqueryUserBy("developerName_select",null,2)}),form.verify({pj_background:function(e){if(e.length<1)return"请输入项目背景"},systemCurrent:function(e){if(e.length<1)return"请输入系统现状"},buildGoal:function(e){if(e.length<1)return"请输入建设目标"},buildContent:function(e){if(e.length<1)return"请输入建设内容"},content:function(e){layedit.sync(editIndex)}});var overviewFlag=0;form.on("submit(save-sumbit)",function(e){return 0==overviewFlag&&(overviewsumbit(),overviewFlag=1),!1});var overvieweditID=null;function overviewsumbit(){var e=$("#pj-background").children("textarea").val(),i=$("#systemCurrent").children("textarea").val(),n=$("#buildGoal").children("textarea").val(),t=$("#buildContent").children("textarea").val(),a={};a.solutionId=additemId,a.projectBackground=e,a.systemCurrent=i,a.buildGoal=n,a.buildContent=t,a.accessToken=accessToken,null!==overvieweditID&&(a.id=overvieweditID),loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveOverview",contentType:"application/json",dataType:"json",data:JSON.stringify(a),success:function(e){200==e.code?($("#project-overview-box").hide(),$("#edit-box-overview").show(),$(".editCon-box").attr("data-edit",e.data),GetitemDestail(2),verifyNum(1),loadingTip.hide(),layer.msg("保存完成!",{icon:1,time:600},function(){})):(loadingTip.hide(),overviewFlag=0,layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){overviewFlag=0,loadingTip.hide(),layer.msg("请求出现错误!!")}})}function editOverview(e){overviewFlag=0,overvieweditID=$(e).data("edit");$("#pj-background").children("textarea").val($(".pj-background").children("p").text()),$("#systemCurrent").children("textarea").val($(".systemCurrent").children("p").text()),$("#buildGoal").children("textarea").val($(".buildGoal").children("p").text()),$("#buildContent").children("textarea").val($(".buildContent").children("p").text());$("#project-overview-box").show(),$("#edit-box-overview").hide()}function showoverviewbtn(){$(".edit-back-box").hover(function(){$(this).find(".edit-con-box-btn").show()},function(){$(this).find(".edit-con-box-btn").hide()})}function additemTemplate(){$("#project-overview-box").show(),$("#pj-overview .levelTips").hide()}$(".cancelEditor").click(function(){$("#project-overview-box").hide(),$("#edit-box-overview").show()}),form.verify({RoleAnalysis:function(e){if(e.length<1)return"请输入功能角色分析"},Requirements:function(e){if(e.length<1)return"请输入业务需求"},dataIntegration:function(e){if(e.length<1)return"请输入数据资源整合"}});var demanFlag=0;form.on("submit(sumbit-deman)",function(e){return 0==demanFlag&&(demansumbit(),demanFlag=1),!1});var demanEdit=null;function demansumbit(){var e=$("#functionalRoleAnalysis").children("textarea").val(),i=$("#businessRequirements").children("textarea").val(),n=$("#dataIntegration").children("textarea").val(),t={};t.solutionId=additemId,t.functionalRoleAnalysis=e,t.businessRequirements=i,t.dataIntegration=n,null!==demanEdit&&(t.id=demanEdit),loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveDemanalysis",contentType:"application/json",dataType:"json",data:JSON.stringify(t),success:function(e){200==e.code?(GetitemDestail(3),$("#demandAnalysis-content-box").hide(),$("#pj-demandAnalysis .addItem-box").css("display","none"),layer.msg("保存完成!",{icon:1,time:600},function(){verifyNum(2)})):(demanFlag=0,loadingTip.hide(),layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){demanFlag=0,layer.msg("请求出现错误!!"),loadingTip.hide()}})}function editdemanna(e){demanFlag=0,demanEdit=$(e).data("edit"),$("#functionalRoleAnalysis").children("textarea").val($(".functionalRoleAnalysis").text()),$("#businessRequirements").children("textarea").val($(".businessRequirements").text()),$("#dataIntegration").children("textarea").val($(".dataIntegration").text()),$("#demandAnalysis-content-box").show(),$(".box-content-deman").hide()}function adddemandAnalysis(){$("#pj-demandAnalysis .levelTips").hide(),$("#demandAnalysis-content-box").show()}$("#demandAnalysis-content-box .close-deman-btn").click(function(){$("#demandAnalysis-content-box").hide(),$(".box-content-deman").show()}),form.verify({frameworkdesign:function(e){if(e.length<1)return"请输入总体架构"},principlesroutes:function(e){if(e.length<1)return"请输入系统建设原则及路线"}});var designFlag=0;form.on("submit(save-design)",function(e){return 0==designFlag&&(designsumbitData(),designFlag=1),!1});var fileListCon,designEdit=null,fileURL=null;function designsumbitData(){var e=$("#frameworkdesign").children("textarea").val(),i=$("#principlesroutes").children("textarea").val(),n={};n.solutionId=additemId,n.frameworkdesign=e,n.topologicalpic=$("#topologicalpic").text(),n.principlesroutes=i,n.accessToken=accessToken,null!==designEdit&&(n.id=designEdit),loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveArchidesign",contentType:"application/json",dataType:"json",data:JSON.stringify(n),success:function(e){200==e.code?(GetitemDestail(4),$("#new-add-back").show(),$("#new-add-design").hide(),$("#pj-design .addItem-box").css("display","none"),layer.msg("保存完成!",{icon:1,time:600},function(){verifyNum(3)})):(designFlag=0,loadingTip.hide(),layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){designFlag=0,layer.msg("请求出现错误!!"),loadingTip.hide()}})}function designEditdata(e){designFlag=0,$("#new-add-design").show(),$("#new-add-back").hide(),designEdit=$(e).data("edit"),$("#frameworkdesign").children("textarea").val($(".frameworkdesign").text()),$("#topologicalpic").text($("#networkImg")[0].src),$("#demo1").attr("src",$("#networkImg")[0].src),$("#principlesroutes").children("textarea").val($(".principlesroutes").text())}function uploadAppIcon(){var e=new FormData;e.append("file",fileListCon),e.append("serviceID","f3295b7e695145509ce6f55de679f1e1"),loadingTip.show(),xhsdk.ajax({url:"xinghuo-apaas-fileservice/breakMultiUploads",type:"POST",contentType:!1,processData:!1,mimeType:"multipart/form-data",data:e,success:function(e){if(200!=(e=JSON.parse(e)).code)return loadingTip.hide(),void layer.msg("图片上传失败，请重新上传！");$("#topologicalpic").text(e.result[0].data.fileUrl),loadingTip.hide()},error:function(e){loadingTip.hide(),layer.msg("请求出现错误!!")}})}function pjdesign(){$("#pj-design .levelTips").hide(),$("#new-add-design").show()}$("#new-add-design .cancelEditor").click(function(){$("#new-add-design").hide(),$("#new-add-back").show()}),upload.render({elem:"#uploadIMG",auto:!1,exts:"jpg|png|gif|bmp|jpeg",choose:function(e){e.preview(function(e,i,n){fileListCon=i,$("#demo1").attr("src",n),$("#topologicalpic").attr("data-imgurl",i.name),uploadAppIcon()})}}),form.verify({serviceName:function(e){if(e.length<1)return"请输入服务名字"},serviceType:function(e){if(e.length<1)return"请选择服务类型"},serviceDesign:function(e){if(e.length<1)return"请输入服务设计"},deploymentEnvironment:function(e){if(e.length<1)return"请选择部署环境"},runResource:function(e){if(e.length<1)return"请选择运行资源"},content:function(e){layedit.sync(editIndex)}});var servicerepeat=0;form.on("submit(save-sumbit-serivce)",function(e){return 0==servicerepeat&&(ServicesumbitData(),servicerepeat=1),!1});var serviceEdit=null;function ServicesumbitData(){var e=formSelects.value("business_select","valStr"),i=formSelects.value("technical_select","valStr");if(e.length<1||i.length<1)layer.msg("请选择依赖的服务！");else{var n={};null!==serviceEdit&&(n.id=serviceEdit),n.solutionId=additemId,n.serviceType=$(".serviceType").val(),n.serviceDesign=$("#serviceDesign").children("textarea").val(),n.basicService=formSelects.value("business_select","valStr"),n.generalService=formSelects.value("technical_select","valStr"),n.serviceName=$("#serviceName").val(),n.deploymentEnvironment=$(".deploymentEnvironment").val(),n.runResource=$(".runResource").val(),n.accessToken=accessToken,loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveMicroservice",contentType:"application/json",dataType:"json",data:JSON.stringify(n),success:function(e){200==e.code?layer.msg("保存完成!",{icon:1,time:600},function(){$(".service-add-box").hide(),$(".service-box").show(),GetitemDestail(null,5),editbth(),verifyNum(5)}):(servicerepeat=0,loadingTip.hide(),layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){servicerepeat=0,layer.msg("请求出现错误!!"),loadingTip.hide()}})}}function cancelselect(){$(".service-box").show(),$(".service-add-box").hide()}function GetserviceData(t,a,o,s,l){var d=[];xhsdk.ajax({url:solution+"/microservice/getServerList",type:"POST",contentType:"application/json",dataType:"json",data:'{"accessToken":"'+accessToken+'"}',success:function(e){if(200==e.code){for(var i=e.data.resulList,n=0;n<i.length;n++)d.push({name:i[n].serverName,value:i[n].serverinfoID});if(formSelects.data(t,"local",{arr:d}),formSelects.data(a,"local",{arr:d}),1==l)return;formSelects.value(t,o,!0),formSelects.value(a,s,!0)}else layer.msg("网络错误！")},error:function(e){layer.msg("数据请求错误!")}})}function pjservice(e){servicerepeat=0,GetserviceData("business_select","technical_select",serviceEdit=null,null,1),$(".service-add-box textarea").val(""),$("#pj-service .levelTips").hide(),$(".service-add-box").show(),$("#serviceName").val("")}function addserviceTemplate(e,i,n,t,a,o,s,l){var d='\n                    <div class="secLevel">\n                        <div class="deploy">\n                            <p class="editTitle">服务名称</p>\n                            <div class="layui-input-inline" style="width: 300px;margin-left: 7px;">\n                                <input type="tel" name="phone" lay-verify="serviceName" autocomplete="off" class="layui-input" id="serviceName" value="'+e+'">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top ">\n                            <div class="deploy">\n                                <p class="editTitle">服务类型</p>\n                                <div class="layui-input-inline option-left" style="width: 300px">\n                                    <select name="quiz" id="service-option" class="serviceType" lay-verify="serviceType">\n                                        <option value=""></option>\n                                        <option value="1">基础技术服务</option>\n                                        <option value="2">通用业务服务</option>\n                                        <option value="3">应用服务</option>\n                                    </select>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">服务设计</p>\n                        </div>\n                        <div class="pj-item-body-bottom" id="serviceDesign">\n                            <textarea class="layui-textarea serviceDesign" lay-verify="serviceDesign" placeholder="请输入服务设计">'+n+'</textarea>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">依赖的服务</p>\n\n                            <div class="editOprate">\n                                <div class="editCon">\n                                    \x3c!--<i class="iconfont icon-bianji"></i>--\x3e\n                                    \x3c!--<span>编辑</span>--\x3e\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="pj-item-body">\n                            <div class="common">通用业务服务(多选)</div>\n                            <div class="box-select-business layui-input-inline" style="margin:20px 0px; width: 100%">\n                                <select xm-select="business_select">\n                                   \n                                </select>\n                            </div>\n                             \n                            <div class="common">基础技术服务(多选)</div> \n                             <div class="box-select-technical layui-input-inline" style="margin:20px 0px;width: 100%">\n                                <select xm-select="technical_select">\n                                             \n                                               \n                                </select>\n                            </div>\n                        </div>\n\n                    </div>\n                    \x3c!--部署环境和运行资源--\x3e\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">部署环境和运行资源</p>\n                        </div>\n                        <div class="deploy-edit">\n                            <div class="deploy-box-tip1">\n                                <div class="deploy">\n                                    <p class="common">部署环境</p>\n                                    <div class="option-box">\n                                        <select name="quiz" id="service" class="deploymentEnvironment" lay-verify="deploymentEnvironment">\n                                            <option value=""></option>\n                                            <option value="移动信息网">移动信息网</option>\n                                            <option value="公安信息网">公安信息网</option>\n                                        </select>\n                                    </div>\n                                </div>\n                                <div class="deploy">\n                                    <p class="common">运行资源</p>\n                                    <div class="option-box">\n                                        <select name="quiz" id="service1" class="runResource" lay-verify="runResource">\n                                            \x3c!--<option value=""></option>--\x3e\n                                            <option value="4G/6核">4G/6核</option>\n                                        </select>\n                                    </div>\n                                </div>\n\n                            </div>\n                        </div>\n                    </div>\n                    <div class="sumbit-button">\n                        <a class="btn-center" lay-submit="" lay-filter="save-sumbit-serivce">保存</a>\n                        <a class="btn-center service-close-btn" onclick="cancelselect()">取消</a>\n                    </div>\n                ';$(".service-add-box").html(d),GetserviceData("business_select","technical_select",t.split(","),a.split(","),3),$("#service-option  option[value = "+i+"]").attr("selected","selected"),$("#service  option[value = "+o+"]").attr("selected","selected"),form.render()}function editservice(e){servicerepeat=0,$(".service-box").hide(),$(".service-add-box").show(),serviceEdit=$(e).data("edit");var i=$(e).parent().parent().find(".serviceName").text(),n=$(e).parent().parent().find(".serviceDesign").text(),t=$(e).parent().parent().find(".option-left").children("select").val(),a=$(e).parent().parent().find(".deploymentEnvironment").val(),o=$(e).parent().parent().find(".runResource").val(),s=$(e).parent().parent().data("id");addserviceTemplate(i,t,n,formSelects.value("business_des"+s,"valStr"),formSelects.value("technical_des"+s,"valStr"),a,o,e)}var E=window.wangEditor,editor=new E("#editor"),filecon=null;editor.customConfig.customUploadImg=function(e,n){filecon=e[0];var i=new FormData;i.append("file",filecon),i.append("serviceID","f3295b7e695145509ce6f55de679f1e1"),loadingTip.hide(),xhsdk.ajax({url:"xinghuo-apaas-fileservice/breakMultiUploads",type:"POST",contentType:!1,processData:!1,mimeType:"multipart/form-data",data:i,success:function(e){if(200==(e=JSON.parse(e)).code){var i=e.result[0].data.fileUrl;n(i)}else layer.msg("图片上传失败，请重新上传！")},error:function(e){loadingTip.hide(),layer.msg("请求出现错误!!")}})},editor.create(),form.verify({applicationName:function(e){if(e.length<1)return"请输入应用名称"},applicationOverview:function(e){if(e.length<1)return"请输入应用概述"},applyLogicdiagram:function(e){if(e.length<1)return"请输入应用功能逻辑"},content:function(e){layedit.sync(editIndex)}});var flagnumber=0;form.on("submit(save-sumbit-application)",function(e){if(0==flagnumber){if(editor.txt.text().length<1)return void layer.msg("请输入应用UI/UE规划");applicationsumbitData(),flagnumber=1}return!1});var appEditID=null;function applicationsumbitData(){var e={};null!==appEditID&&(e.id=appEditID),e.solutionId=additemId,e.applicationOverview=$("#applicationOverview").children("textarea").val(),e.applicationPlanning=editor.txt.html(),e.applyLogicdiagram=$("#applyLogicdiagram").children("textarea").val(),e.frontIntegration=formSelects.value("select-id","valStr"),e.applicationName=$("#applicationName").val(),e.accessToken=accessToken,loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveApplicationdesign",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){200==e.code?layer.msg("保存完成!",{icon:1,time:600},function(){appEditID=null,$(".add-application-box").hide(),$(".application-box").show(),GetitemDestail(null,6),editbth(),verifyNum(6)}):(loadingTip.hide(),flagnumber=0,layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){flagnumber=0,loadingTip.hide(),layer.msg("请求出现错误!!")}})}function pjapplication(e){flagnumber=0,appEditID=null,$(".add-application-box textarea").val(""),$("#applicationName").val(""),$(".add-application-box input").attr("checked",!1),$("#pj-application .levelTips").hide(),$(".add-application-box").show(),editor.txt.html(""),formSelects.value("select-id",[])}function applictionTemplate(e,i,n,t,a){var o='<div class="secLevel">\n                        <div class="deploy">\n                            <p class="editTitle">应用名称</p>\n                            <div class="layui-input-inline" style="width: 500px;margin-left: 7px;">\n                                <input type="tel" name="phone" lay-verify="applicationName" autocomplete="off" class="layui-input" id="applicationName" value="'+e+'">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">应用概述</p>\n                        </div>\n                        <div class="pj-item-body-bottom" id="applicationOverview">\n                            <textarea class="layui-textarea" lay-verify="applicationOverview" placeholder="请输入应用概述">'+i+'</textarea>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">应用UI/UE规划</p>\n                        </div>\n                        <div class="pj-item-body-bottom" id="applicationPlanning">\n                             <div id="editor"></div>\n                            \x3c!--<textarea class="layui-textarea" lay-verify="applicationPlanning" placeholder="请输入应用UI/UE规划">'+applicationPlanning+'</textarea>--\x3e\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <p class="editTitle">应用功能逻辑</p>\n                        </div>\n                        <div class="pj-item-body-bottom" id="applyLogicdiagram">\n                            <textarea class="layui-textarea" lay-verify="applyLogicdiagram" placeholder="请输入应用功能逻辑">'+t+'</textarea>\n                        </div>\n                    </div>\n                    <div class="secLevel">\n                        <div class="pj-item-body-top">\n                            <div class="deploy">\n                                <p class="editTitle">前端服务化能力集成</p>\n                                \n                                <div class="layui-input-inline option-left" style="z-index: 999999" >\n                                    <div class="layui-input-block" style="width: 600px;margin-left: 40px" >              \n                                              <select xm-select="select-id" xm-select-search="">\n                                                <option value="1">人脸识别服务</option>\n                                                <option value="2">车牌识别服务</option>\n                                                <option value="3">证件识别服务</option>\n                                                <option value="4">扫一扫服务</option>\n                                                <option value="5">证件识别服务</option>\n                                                <option value="6">选择文件</option>\n                                                <option value="7">电子签名</option>\n                                                <option value="8">获取定位</option>\n                                                <option value="9">获取手机状态（NFC、蓝牙、GPS、WIFI等）</option>\n                                                <option value="10">设置手机状态（NFC、蓝牙、GPS、WIFI等）</option>\n                                                <option value="11">获取海拔</option>\n                                                <option value="12">图片压缩</option>\n                                            </select>\n                                      \n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="sumbit-button">\n                        <a class="btn-center" lay-submit="" lay-filter="save-sumbit-application">保存</a>\n                        <a class="btn-center close-application-box" onclick="closeapplicationbox()">取消</a>\n                    </div>';$(".add-application-box").html(o),editor.create(),editor.txt.html("<p>"+n+"</p>"),formSelects.render("select-id");var s=a.split(",");formSelects.value("select-id",s,!0),form.render()}function editapplication(e){flagnumber=0,$(".application-box").hide(),$(".add-application-box").show(),appEditID=$(e).data("edit");var i=$(e).parent().parent().find(".applicationName").text(),n=$(e).parent().parent().find(".applicationOverview").text(),t=$(e).parent().parent().find(".applicationPlanning"),a=[];$(t).each(function(e,i){a.push($(this).html())});var o=$(e).parent().parent().find(".applyLogicdiagram").text(),s=$(e).parent().parent().data("id"),l=formSelects.value("select-id"+s,"valStr");applictionTemplate(i,n,a,o,l)}function closeapplicationbox(){$(".application-box").show(),$(".add-application-box").hide()}function showedit(){$(".add-deploy-box").hover(function(){$(this).find(".change-btn").show(),$(this).css("border","1px solid #ccc")},function(){$(this).find(".change-btn").hide(),$(this).css("border","1px solid #fff")})}form.verify({riskSolution:function(e){if(e.length<1)return"请输入风险解决方案"}});var RiskFalg=0;form.on("submit(save-sumbit-Risksolution)",function(e){return 0==RiskFalg&&(saveRisksolution(),RiskFalg=1),!1}),$("#pj-solution .addItem-box").click(function(){$("#pj-solution .levelTips").hide(),$(".add-solution-box").show()});var solutionEditID=null;function saveRisksolution(){$(".add-solution-box").hide();var e={};null!==solutionEditID&&(e.id=solutionEditID),e.solutionId=additemId,e.riskSolution=$("#riskSolution").val(),e.accessToken=accessToken,$(".add-box-tip .editCon-btn").show(),$("#pj-solution .editOprate").show(),$(".edit-solution-box").show(),showsolution(),loadingTip.show(),xhsdk.ajax({type:"post",url:solution+"/projectManagement/saveRisksolution",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){200==e.code?(loadingTip.hide(),solutionEditID=e.data,GetitemDestail(7),$(".add-box-tip .editCon-btn").attr("data-edit",e.data),$("#pj-solution .addItem-box").hide(),layer.msg("保存完成!",{icon:1,time:600},function(){verifyNum(7)})):(RiskFalg=0,loadingTip.hide(),layer.alert("字数过多,请删减!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}))},error:function(e){RiskFalg=0,loadingTip.hide(),layer.msg("请求出现错误!!")}})}function editsolution(e){var i=$(e).data("edit");solutionEditID=i,$(".edit-solution-box").hide(),$(".add-solution-box").show(),$(".add-solution-box .editCon-btn").hide(),$("#pj-solution .sumbit-button-box").show();var n=$(".riskSolution").text();$("#riskSolution").val(n)}function loadingverify(){var t=[];$(".anchorNav ul li").each(function(e,i){var n=$(this).hasClass("verify");t.push(n)});for(var e=[],i=0;i<t.length;i++)1==t[i]&&e.push(t[i]);if(1<=e.length){var n=$(".pjprogress_txt span"),a=$(".layui-progress-bar");switch(e.length){case 1:n.text("10%"),a.css("width","10%");break;case 2:n.text("25%"),a.css("width","25%");break;case 3:n.text("30%"),a.css("width","30%");break;case 4:n.text("45%"),a.css("width","45%");break;case 5:n.text("60%"),a.css("width","60%");break;case 6:n.text("65%"),a.css("width","65%");break;case 7:n.text("75%"),a.css("width","75%");break;case 8:n.text("90%"),a.css("width","90%");break;case 9:n.text("100%"),a.css("width","100%");break;default:n.text("0%"),a.css("width","0%")}}}function preview(){layer.open({type:2,title:"实施方案详情",shadeClose:!0,maxmin:!0,area:["100%","100%"],content:"../pm_setDoc_deastail/pm_setDoc_deastail.html?tag=1&itemID="+additemId+"&TokenCode="+accessToken})}$(".close-solution-box").click(function(){$(".add-solution-box").hide(),$(".edit-solution-box").show()}),$("#pj-overview .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_overview/pm_overview.html?help=1&TokenCode="+accessToken)}),$("#pj-demandAnalysis .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_demandAnalysis/pm_demandAnalysis.html?help=1&TokenCode="+accessToken)}),$("#pj-design .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_design/pm_design.html?help=1&TokenCode="+accessToken)}),$("#pj-service .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_service/pm_service.html?help=1&TokenCode="+accessToken)}),$("#pj-application .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_application/pm_application.html?help=1&TokenCode="+accessToken)}),$("#pj-solution .pj-item-header-left p:nth-of-type(2)").click(function(){window.open("../pm_setDoc/pm_solution/pm_solution.html?help=1&TokenCode="+accessToken)});var Dep_URL,allocationFlag=null;function allocation(e){allocationFlag=e,$(".popUpbox").show(),function(e,i){$("#Personnel").empty();var n={accessToken:accessToken,deptCode:sessionStorage.getItem("deptCode")};indexloading=layer.load(2,{shade:!1}),Dep_URL=solution+"/solutioninfo/queryUserByDeptCode",xhsdk.ajax({type:"post",url:Dep_URL,contentType:"application/json",dataType:"json",data:JSON.stringify(n),success:function(e){if(200==e.code){if(layer.close(indexloading),null==e.data)return void layer.msg("暂无数据");var i=e.data;Personnel(i)}else layer.close(indexloading),layer.msg("请求出现错误!!")},error:function(e){layer.close(indexloading),layer.msg("请求出现错误!!")}})}()}function Personnel(e){$("#Personnel").empty();for(var i=null,n=0;n<e.length;n++){i=e[n].job,$('<div class="option-checkbox" data-id="'+n+'"><input type="radio" name="like1[write]" lay-skin="primary" title="'+i+'"  value="'+i+'" lay-filter="staffCheckbox"></div>').appendTo("#Personnel"),form.render()}}var staff=null;function sumbitData(e){var t=[];if($(".anchorNav ul li").each(function(e,i){var n=$(this).hasClass("verify");t.push(n)}),null!=readstatus&&""!=readstatus){for(var i=[],n=0;n<t.length;n++)1==t[n]&&i.push(t[n]);i.length<9?layer.alert("请把必填项填写完成!",{skin:"layui-layer-molv",closeBtn:1,shadeClose:!0}):layer.confirm("确认提交审核吗？",{btn:["确认","取消"]},function(){indexloading=layer.load(2,{shade:!1});var e={accessToken:accessToken,id:additemId,isRead:readstatus};xhsdk.ajax({type:"post",url:solution+"/solutioninfo/apply",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(e){200==e.code?(layer.close(indexloading),layer.msg("提交完成!",{icon:1,time:600},function(){loadingTip.hide(),parent.location.reload(),layer.close()})):(layer.close(indexloading),layer.msg("请求错误!"))},error:function(e){layer.close(indexloading),layer.msg("请求出现错误!!")}})},function(){layer.close(indexloading),layer.msg("已取消")})}else layer.msg("请阅读开发规范")}form.on("radio(staffCheckbox)",function(e){staff=e.value}),$(".editContent").on("click",".getDocData",function(){if(null!=staff){1<(2==allocationFlag?$(".stafffzr").val():$("#kfdevelopOrgan").val()).split(",").length?layer.msg("不能在添加了"):($(".popUpbox").hide(),2==allocationFlag?($(".stafffzr").val($(".stafffzr").val()+","+staff),$("#staffvalue").append(staff)):$("#kfdevelopOrgan").val(staff),form.render())}else layer.msg("请选择!")}),$(".right-box-search").click(function(){layer.msg("正在开发中...")}),$(".btn-group").on("click",".cancelEditor",function(){layer.close(indexloading),$(".popUpbox").hide()});